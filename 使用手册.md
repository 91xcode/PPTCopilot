# PPT Copilot 使用手册

## 📋 目录
1. [系统简介](#系统简介)
2. [环境要求](#环境要求)
3. [安装部署](#安装部署)
4. [功能使用](#功能使用)
5. [AI模型配置](#ai模型配置)
6. [常见问题](#常见问题)
7. [故障排除](#故障排除)

## 🎯 系统简介

PPT Copilot 是一个基于AI的智能PPT生成和编辑系统，支持：

- **🤖 AI大纲生成**：根据主题自动生成PPT大纲
- **📝 智能内容填充**：AI自动生成每页PPT的详细内容
- **🎨 在线编辑**：强大的在线PPT编辑功能
- **📋 项目管理**：用户和项目管理系统
- **🏠 本地化支持**：支持本地ollama模型，无需API费用

## 🔧 环境要求

### 系统要求
- **操作系统**：macOS / Linux / Windows (WSL2)
- **内存**：建议8GB以上
- **存储空间**：至少10GB可用空间

### 必需软件
- **Docker** & **Docker Compose**
- **Git**
- **Ollama**（可选，用于本地AI模型）

## 🚀 安装部署

### 1. 克隆项目
```bash
git clone <your-repo-url>
cd PPTCopilot
```

### 2. 初始化子模块
```bash
git submodule init
git submodule update
```

### 3. 启动系统
```bash
# 启动所有服务
docker-compose up -d

# 查看服务状态
docker-compose ps
```

### 4. 访问系统
- **项目管理界面**：http://localhost:9529
- **PPT编辑器**：http://localhost:7777
- **后端API**：http://localhost:8080
- **数据库**：localhost:3307

## 👥 用户系统

### 默认测试账号
- **用户名**：`hughdazz`
- **密码**：`123456`
- **邮箱**：`1@qq.com`

### 注册新用户
1. 访问 http://localhost:9529
2. 点击"注册"链接
3. 填写用户名、密码、邮箱
4. 完成注册后登录

## 📝 功能使用

### 创建PPT项目

1. **登录系统**
   - 访问 http://localhost:9529
   - 使用账号密码登录

2. **新建项目**
   - 点击"新建项目"按钮
   - 填写项目名称和描述
   - 选择项目封面（可选）

3. **创建PPT文件**
   - 进入项目详情页面
   - 点击"新建PPT"按钮
   - 输入幻灯片标题

### AI生成PPT

1. **输入基本信息**
   - **主题**：输入PPT主题（如"人工智能发展趋势"）
   - **汇报人**：输入汇报人姓名
   - **选择模板**：选择合适的PPT模板

2. **生成大纲**
   - 点击"创建PPT"按钮
   - AI将自动生成PPT大纲
   - 可以编辑大纲内容（点击Append/Edit）

3. **生成内容**
   - 确认大纲后，点击"创建PPT"
   - 系统将为每页生成详细内容
   - 等待处理完成（时间较长，请耐心等待）

4. **在线编辑**
   - 生成完成后自动跳转到编辑器
   - 使用编辑工具调整样式和内容
   - 支持文本、图片、形状等元素编辑

### 项目管理

1. **文件管理**
   - 上传文件：支持各种格式文件上传
   - 重命名：右键菜单选择"重命名"
   - 删除：右键菜单选择"删除"
   - 下载：右键菜单选择"下载"

2. **项目收藏**
   - 在项目详情页点击"添加收藏"
   - 在个人空间查看收藏的项目

3. **项目克隆**
   - 点击"克隆项目"复制他人项目
   - 可在"我的项目"中查看克隆的项目

## 🤖 AI模型配置

### OpenAI配置（需要API密钥）
```bash
# 编辑配置文件
vim PPTCopilot-backend/conf/gpt.conf

# 修改以下配置
gpt_api_url = `https://api.openai.com/v1/chat/completions`
gpt_model = `gpt-3.5-turbo`
gpt_api_key = `your-openai-api-key`
```

### Ollama本地模型配置（推荐）

1. **安装Ollama**
   ```bash
   # macOS
   curl -fsSL https://ollama.ai/install.sh | sh
   
   # 启动服务
   ollama serve
   ```

2. **下载模型**
   ```bash
   # 推荐：通义千问（中文优化）
   ollama pull qwen3:4b-instruct
   
   # 其他选择
   ollama pull llama3.1
   ollama pull deepseek-r1:7b-qwen-distill-q4_K_M
   ```

3. **配置文件**（已配置好）
   ```bash
   gpt_api_url = `http://host.docker.internal:11434/v1/chat/completions`
   gpt_model = `qwen3:4b-instruct`
   gpt_proxy = ``
   gpt_api_key = `ollama-local-key`
   ```

4. **重启服务**
   ```bash
   docker-compose restart pptcopilot-backend
   ```

## 🎨 编辑器功能

### 基本编辑
- **文本编辑**：双击文本框进行编辑
- **样式调整**：使用右侧工具栏调整字体、颜色、大小
- **对齐方式**：左对齐、居中、右对齐
- **添加元素**：文本框、图片、形状、图表

### 高级功能
- **动画效果**：为元素添加进入、强调、退出动画
- **幻灯片切换**：设置幻灯片之间的过渡效果
- **母版编辑**：统一设置幻灯片样式
- **导出功能**：导出为PDF、图片等格式

### 快捷键
- `Ctrl+Z`：撤销
- `Ctrl+Y`：重做
- `Ctrl+C`：复制
- `Ctrl+V`：粘贴
- `Delete`：删除选中元素

## 🔧 常见问题

### Q: PPT生成速度慢？
A: 
- 使用本地ollama模型会更快
- 检查网络连接（如使用OpenAI）
- 简化PPT主题描述

### Q: 登录时提示"no row found"？
A: 
- 检查数据库服务是否正常
- 确认用户账号是否存在
- 重新注册账号

### Q: 编辑器加载不出来？
A: 
- 检查端口7777是否被占用
- 清除浏览器缓存
- 检查Docker服务状态

### Q: AI生成内容质量不佳？
A: 
- 使用更详细的主题描述
- 尝试不同的AI模型
- 手动编辑AI生成的内容

## 🚨 故障排除

### 服务无法启动
```bash
# 查看服务状态
docker-compose ps

# 查看错误日志
docker-compose logs [service-name]

# 重启所有服务
docker-compose restart

# 重新构建服务
docker-compose build --no-cache
```

### 端口冲突
```bash
# 检查端口占用
lsof -i :8080
lsof -i :7777
lsof -i :9529
lsof -i :3307

# 修改docker-compose.yml中的端口映射
```

### 数据库连接问题
```bash
# 检查MySQL服务
docker exec -it some-mysql mysql -uroot -padmin

# 重启MySQL
docker-compose restart mysqldb

# 查看数据库日志
docker-compose logs mysqldb
```

### Ollama连接问题
```bash
# 检查ollama服务状态
ollama list
curl http://localhost:11434/v1/models

# 重启ollama服务
ollama serve

# 检查容器网络连接
docker exec ppt-backend curl http://host.docker.internal:11434/v1/models
```

## 📞 技术支持

如遇到问题，请提供：
1. 错误信息截图
2. 系统日志
3. 操作步骤
4. 环境信息

## 📝 更新日志

### v1.0.0
- ✅ 基本PPT生成功能
- ✅ 用户管理系统
- ✅ 在线编辑器
- ✅ Ollama本地模型支持

---

**PPT Copilot** - 让AI为您的演示文稿添彩！ 🎨✨
